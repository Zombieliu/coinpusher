# 🔒 安全配置
# 内部服务通信密钥（用于Room Server <-> Gate Server）
# 生产环境请使用强随机字符串，至少32字符
INTERNAL_SECRET_KEY=REPLACE_WITH_STRONG_RANDOM_KEY_AT_LEAST_32_CHARS

# 🔒 传输加密配置
# 环境模式（development/production）
NODE_ENV=development

# 强制启用HTTPS/WSS（生产环境自动启用）
FORCE_HTTPS=false

# 启用协议层加密（生产环境自动启用）
ENABLE_SECURITY=false

# 🔒 客户端完整性校验
# 启用严格模式（检测到代码被修改时阻止登录）
INTEGRITY_CHECK_STRICT=false

# 🔒 物理引擎快照签名
# 启用快照签名验证（生产环境自动启用）
ENABLE_SNAPSHOT_SIGNATURE=false

# Gate Server 配置
GATE_URL=http://127.0.0.1:3000
GATE_PORT=3000

# Room Server 配置
ROOM_PORT=3001

# Match Server 配置
MATCH_PORT=3002

# MongoDB 配置
# ⚠️ 生产环境必须配置认证！格式：
# MONGODB_URI=mongodb://username:password@localhost:27017/coinpusher_game?authSource=coinpusher_game
# 开发环境（本地无认证）：
MONGODB_URI=mongodb://localhost:27017/coinpusher_game

# MongoDB 认证配置（生产环境必填）
# 创建用户的命令见 docs/MONGODB_SETUP.md
MONGODB_USER=coinpusher_app
MONGODB_PASSWORD=REPLACE_WITH_STRONG_PASSWORD

# 🔒 请求签名配置
# 启用请求签名验证（production环境建议设为true）
ENABLE_REQUEST_SIGNATURE=true

# 🔒 时间戳防重放
# 请求时间戳容差（秒）
TIMESTAMP_TOLERANCE_SECONDS=5

# 🔒 速率限制配置
# 投币冷却时间（毫秒）
DROP_COIN_COOLDOWN_MS=500

# 投币频率限制（每分钟最大次数）
DROP_COIN_MAX_PER_MINUTE=60

# 🎮 游戏配置
# 每日奖励上限（金币）
DAILY_REWARD_LIMIT=1000

# 单次最大投币金额
MAX_COIN_VALUE=10

# ========================================
# 🚀 性能监控配置 (P3)
# ========================================
# 监控服务器端口
MONITORING_PORT=9090
MATCH_MONITORING_PORT=9091
ROOM_MONITORING_PORT=9092

# Prometheus 配置
PROMETHEUS_ENABLED=true
METRICS_PREFIX=coinpusher

# 健康检查超时（毫秒）
HEALTH_CHECK_TIMEOUT=5000

# ========================================
# 💾 缓存配置 (P2)
# ========================================
# DragonflyDB/Redis 配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
# 生产环境建议设置密码:
# REDIS_PASSWORD=your-strong-password

# Redis 连接配置
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1000

# 内存缓存配置
MEMORY_CACHE_MAX_SIZE=1000
MEMORY_CACHE_DEFAULT_TTL=300000

# Redis 缓存 TTL（毫秒）
REDIS_CACHE_DEFAULT_TTL=3600000

# 缓存键前缀
CACHE_KEY_PREFIX=coinpusher

# ========================================
# 📊 日志配置 (P0)
# ========================================
LOG_LEVEL=info
# 可选值: debug, info, warn, error

# 日志文件路径
LOG_FILE_PATH=./logs/app.log
LOG_ERROR_FILE_PATH=./logs/error.log

# 日志保留天数
LOG_MAX_FILES=30

# API 请求日志
LOG_API_REQUESTS=true

# ========================================
# 🔔 告警配置
# ========================================
# Slack Webhook (可选)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK

# 邮件告警配置 (可选)
ALERT_EMAIL_SMTP_HOST=smtp.gmail.com
ALERT_EMAIL_SMTP_PORT=587
ALERT_EMAIL_FROM=alertmanager@example.com
ALERT_EMAIL_TO=ops-team@example.com
ALERT_EMAIL_PASSWORD=your-password

# ========================================
# 🐳 Docker 部署配置
# ========================================
# Docker Compose 服务名
GATE_SERVICE_NAME=gate-server
MATCH_SERVICE_NAME=match-server
ROOM_SERVICE_NAME=room-server
MONGODB_SERVICE_NAME=mongodb
REDIS_SERVICE_NAME=dragonflydb

# ========================================
# ⚡ 性能配置
# ========================================
# MongoDB 连接池
MONGODB_MAX_POOL_SIZE=100
MONGODB_MIN_POOL_SIZE=10

# 限流配置
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# PM2 进程数量
PM2_INSTANCES=4

# ========================================
# 🌍 其他配置
# ========================================
# 时区
TZ=Asia/Shanghai

# CORS 配置
CORS_ORIGIN=*
# 生产环境建议设置具体域名:
# CORS_ORIGIN=https://yourgame.com

# 调试模式
DEBUG=false

# 性能分析
ENABLE_PROFILING=false
